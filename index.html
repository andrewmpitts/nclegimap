<html>
<head>
    <title>A D3 map</title>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <!--<script src="nc2.js"></script>-->
    <!--<script src="ncsgeomin.js"></script>-->
</head>
<body>
<script>
    var openStatesURL = "https://openstates.org/api/v1/METHOD/";
    var ncMetadataURL = "openstates.org/api/v1/metadata/nc/";
    var ncLegislatorsURL = "https://openstates.org/api/v1/legislators/?state=nc";
    var ncSenateURL = "https://openstates.org/api/v1/legislators/?state=nc&chamber=upper";
    var ncRepURL = "https://openstates.org/api/v1/legislators/?state=nc&chamber=lower";
    var billLookupURL = "https://openstates.org/api/v1/bills/NCB00010747/";
    var hbBillURL = "https://openstates.org/api/v1/bills/NCB00009985/"; //Detailed bill example

    var billIds = [];

    var width = 1000, height = 450;
//
    var svgRepMap = d3.select( "body" )
            .append( "svg" )
            .attr( "id", "ncRepMap")
            .attr( "width", width )
            .attr( "height", height );

    var svgSenMap = d3.select( "body" )
            .append( "svg" )
            .attr( "id", "ncSenMap")
            .attr( "width", width )
            .attr( "height", height );

    var svgCongressMap = d3.select( "body" )
            .append( "svg" )
            .attr( "id", "ncSenMap")
            .attr( "width", width )
            .attr( "height", height );

    var gr = svgRepMap.append( "g" );
    var gs = svgSenMap.append( "g" );
    var gCon = svgCongressMap.append( "g" );

    var albersProjection = d3.geo.albersUsa()
            .scale(7000)
//            .rotate( [71.057,0] )
//            .center( [0, 42.313] )
            .translate( [-1200,0] );

    var geoPath = d3.geo.path()
            .projection( albersProjection );
var i = 0;

    var republicanColor = "#E54B0B";
    var democratColor = "#2590FA";
    var independentColor = "#AAADAD";

    d3.json("ncsgeo/ncrepdistrictsmin.json", function (json) {
        console.log(json);
        gr.selectAll("path")
                .data(json.features)
                .enter()
                .append("path")
                .attr("fill", "#ffffff")
                .attr("stroke", "#888888")
                .each(function(d, i) {
                    var district = d.properties.District;
                    d3.select(this)
                        .attr("id", "d" + district)
                        .attr("onmouseover", 'd3.select(d' + district + ').attr("fill", "' + democratColor + '")')
                        .attr("onclick", "console.log(" + district + ")")
                        .attr("onmouseout", 'd3.select(d' + district + ').attr("fill", "#ffffff")');
            })
                .attr("d", geoPath);
    });

    d3.json("ncsgeo/ncsendistrictsmin.json", function (json) {
        console.log(json);
        gs.selectAll("path")
                .data(json.features)
                .enter()
                .append("path")
                .attr("fill", "#ffffff")
                .attr("stroke", "#888888")
                .each(function(d, i) {
                    var district = d.properties.District;
                    d3.select(this)
                            .attr("id", "s" + district)
                            .attr("onmouseover", 'd3.select(s' + district + ').attr("fill", "' + democratColor + '")')
                            .attr("onclick", "console.log(" + district + ")")
                            .attr("onmouseout", 'd3.select(s' + district + ').attr("fill", "#ffffff")');
                })
                .attr("d", geoPath);
    });

    d3.json("ncsgeo/ncdccongressdistrictsmin.json", function (json) {
        console.log(json);
        gCon.selectAll("path")
                .data(json.features)
                .enter()
                .append("path")
                .attr("fill", "#ffffff")
                .attr("stroke", "#888888")
                .each(function(d, i) {
                    var district = d.properties.District;
                    d3.select(this)
                            .attr("id", "con" + district)
                            .attr("onmouseover", 'd3.select(con' + district + ').attr("fill", "' + democratColor + '")')
                            .attr("onclick", "console.log(" + district + ")")
                            .attr("onmouseout", 'd3.select(con' + district + ').attr("fill", "#ffffff")');
                })
                .attr("d", geoPath);
    });


//    features.properties.districts for district numbers

//    g.selectAll( "path" )
//            .data( neighborhoods_json.features )
////            .data( neighborhoods_json.geometries )
//            .enter()
//            .append( "path" )
//            .attr( "fill", "#ffffff" )
//            .attr("stroke", "#888888")
////            .each(function(d, i) {
////                d3.select(this)
//////                    .attr("id", countyNames[i])
////                        .attr("id", "c" + i)
////                        .attr("onmouseover", 'd3.select(c' + i + ').attr("fill", "' + democratColor + '")')
//////                        .attr("onmouseover", "console.log(countyNames[" + i + "])");
////                        .attr("onmouseout", 'd3.select(c' + i + ').attr("fill", "#ffffff")');
////
////            })
//            .attr( "d", geoPath );



//    var width  = 1400;
//    var height = 600;
//
//    var vis = d3.select("body").append("svg")
//            .attr("width", width).attr("height", height)
//
//    d3.json("ncsgeo/ncrepdistrictsmin.json", function(json) {
//        // create a first guess for the projection
//        var center = d3.geo.centroid(json)
//        var scale  = 150;
//        var offset = [width/2, height/2];
//        var projection = d3.geo.mercator().scale(scale).center(center)
//                .translate(offset);
//
//        // create the path
//        var path = d3.geo.path().projection(projection);
//
//        // using the path determine the bounds of the current map and use
//        // these to determine better values for the scale and translation
//        var bounds  = path.bounds(json);
//        var hscale  = scale*width  / (bounds[1][0] - bounds[0][0]);
//        var vscale  = scale*height / (bounds[1][1] - bounds[0][1]);
//        var scale   = (hscale < vscale) ? hscale : vscale;
//        var offset  = [width - (bounds[0][0] + bounds[1][0])/2,
//            height - (bounds[0][1] + bounds[1][1])/2];
//
//        // new projection
//        projection = d3.geo.mercator().center(center)
//                .scale(scale).translate(offset);
//        path = path.projection(projection);
//
//        // add a rectangle to see the bound of the svg
//        vis.append("rect").attr('width', width).attr('height', height)
//                .style('stroke', 'black').style('fill', 'none');
//        console.log(json)
//        vis.selectAll("path").data(json.features).enter().append("path")
//                .attr("d", path)
//                .style("fill", "white")
//                .style("stroke-width", "1")
//                .style("stroke", "black")
//    });





//    var width  = 1400;
//    var height = 600;
//
//    var vis = d3.select("body").append("svg")
//            .attr("width", width).attr("height", height)
//
//    d3.json("ncsgeo/ncrepdistrictsmin.json", function(json) {
//        // create a first guess for the projection
//        var center = d3.geo.centroid(json)
//        var scale  = 150;
//        var offset = [width/2, height/2];
//        var projection = d3.geo.mercator().scale(scale).center(center)
//                .translate(offset);
//
//        // create the path
//        var path = d3.geo.path().projection(projection);
//
//        // using the path determine the bounds of the current map and use
//        // these to determine better values for the scale and translation
//        var bounds  = path.bounds(json);
//        var hscale  = scale*width  / (bounds[1][0] - bounds[0][0]);
//        var vscale  = scale*height / (bounds[1][1] - bounds[0][1]);
//        var scale   = (hscale < vscale) ? hscale : vscale;
//        var offset  = [width - (bounds[0][0] + bounds[1][0])/2,
//            height - (bounds[0][1] + bounds[1][1])/2];
//
//        // new projection
//        projection = d3.geo.mercator().center(center)
//                .scale(scale).translate(offset);
//        path = path.projection(projection);
//
//        // add a rectangle to see the bound of the svg
//        vis.append("rect").attr('width', width).attr('height', height)
//                .style('stroke', 'black').style('fill', 'none');
//        console.log(json)
//        vis.selectAll("path").data(json.features).enter().append("path")
//                .attr("d", path)
//                .style("fill", "red")
//                .style("stroke-width", "1")
//                .style("stroke", "black")
//    });





//    console.log(

//    console.log(countyNames);


//    d3.select("path#c0").attr( "fill", "#220099" );

//console.log(neighborhoods_json.features[10]);
//            neighborhoods_json.features[0].properties.name
//    );
</script>
</body>
</html>